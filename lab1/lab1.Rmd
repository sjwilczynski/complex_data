---
title: "Complex Data - lab1"
author: "Stanisław Wilczyński"
date: "8 maja 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Tak1


```{r cars}
lead <- read.table(file = "../data/lead.txt", header = FALSE)
names(lead) <- c("id", "baseline", paste("week", c(1,4,6), sep=""))
summary(lead)
```

```{r}
mean.y <- apply(lead[,2:5], 2, mean)
print(mean.y)
sd.y <- apply(lead[,2:5], 2, sd)
print(sd.y)
apply(lead[,2:5], 2, summary)
```

```{r}
library(reshape2)
lead.uni <- melt(lead, id.vars = c("id"), value.name = "y")
lead.uni <- lead.uni[c(1,3)]
lead.uni <- lead.uni[order(lead.uni$id),]
lead.uni$time <- rep(c(0,1,4,6))
lead.uni$time.cat <- rep(1:4)
head(lead.uni)
```
```{r}
library(nlme)
lead.cat <- gls(y~factor(time.cat),
correlation=corSymm(form= ~1 | id),
weights=varIdent(form= ~1 | factor(time.cat)),
data=lead.uni)
summary(lead.cat)
```
```{r}
covariance.matrix <- getVarCov(lead.cat)
print(covariance.matrix)
```

Covariance matrices are different because of sigma_11 - residual standard error.
task 1 - var(Y) or var(Y|X)
task 3 - what can we assume (maybe the same variances, correlations)
task 6 - use a test

```{r}
lead.cat.ml <- gls(y~factor(time.cat),
correlation=corSymm(form= ~1 | id),
weights=varIdent(form= ~1 | factor(time.cat)),
data=lead.uni, method = "ML")
summary(lead.cat.ml)
covariance.matrix.ml <- getVarCov(lead.cat.ml)
print(covariance.matrix.ml)
```
```{r}
getVarCov(lead.cat.ml)

```

